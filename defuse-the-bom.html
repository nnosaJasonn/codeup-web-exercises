<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Defuse the BOM</title>
</head>
<body>

<h2 id="message">This BOM will self destruct in <span id="timer">5</span> seconds...</h2>
<button id="defuser">Defuse the BOM</button>

<h3 id="stopWatch"></h3>

<script>
    /*(function() {*/
    "use strict";
    /*

        var detonationTimer = 5;

        var intervalId = setInterval(updateTimer,1000);


        // TODO: This function needs to be called once every second
        function updateTimer() {
            if (detonationTimer == 0) {
                alert('EXTERMINATE!');
                document.body.innerHTML = '';
            } else if (detonationTimer > 0) {
                document.getElementById('timer').innerHTML = detonationTimer;
            }

            detonationTimer--;
        }

        // TODO: When this function runs, it needs to
        // cancel the interval/timeout for updateTimer()
        function defuseTheBOM() {
            clearInterval(intervalId)
        }

        // Don't modify anything below this line!
        //
        // This causes the defuseTheBOM() function to be called
        // when the "defuser" button is clicked.
        // We will learn about events in the DOM lessons
        var defuser = document.getElementById('defuser');
        defuser.addEventListener('click', defuseTheBOM);
    */


    var jackBox = {};
    jackBox.triggered = false;
    jackBox.intervalId = null;

    jackBox.lyrics = ["All a-...",
        "-round the ...",
        "mulberry...",
        "bush, The...",
        "monkey...",
        "chased the...",
        "wea-...",
        "-sel...",
        "The monkey...",
        "stopped to...",
        "pull up his...",
        "sock,...",
        "Pop!...",
        "goes the...",
        "wea-...",
        "-sel."];
    jackBox.play = function () {
        var x = -1;


        var lyricStart = 0;
        var lyricEnd = jackBox.lyrics.length;
        var interval = 1000; // interval time in milliseconds

        var intervalId = setInterval(function () {
            if (jackBox.triggered === false) {
                if (lyricStart >= lyricEnd) {
                    clearInterval(intervalId);
                    console.log('All done');
                    alert('POP!');
                    jackBox.triggered = true;
                } else {
                    x++;
                    lyricStart++;
                    console.log(jackBox.lyrics[x]);

                }
            }
        }, interval);
    };

    jackBox.windUp = function () {
        jackBox.triggered = true;
    };

    jackBox.play();

    var stopwatchID = setInterval(updateTimer, 1000);

    var stopWatchCount = 0;

    function updateTimer() {
        stopWatchCount++;
        document.getElementById('stopWatch').innerHTML = stopWatchCount;
        return stopWatchCount;
    }

    var stopWatch = {};

    stopWatch.intervalId = null;


    /*})();*/
</script>
</body>
</html>
